--
describe employees;
select *
from employees
limit 10;

-- index range scan
explain analyze
select *
from employees
where emp_no > 10;
# | EXPLAIN                                                                                                                                                                                                                                           |
#     +---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
#     | -> Filter: (employees.emp_no > 10)  (cost=30121.09 rows=149756) (actual time=0.066..116.182 rows=300024 loops=1)
#     -> Index range scan on employees using PRIMARY  (cost=30121.09 rows=149756) (actual time=0.065..90.215 rows=300024 loops=1)
#     |
#     +---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
#     1 row in set (0.15 sec)

explain analyze
select *
from employees
where emp_no > 10
  and emp_no < 300;
# | EXPLAIN                                                                                                                                                                                                                                           |
#     +---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
#     | -> Filter: ((employees.emp_no > 10) and (employees.emp_no < 300))  (cost=1.21 rows=1) (actual time=0.014..0.014 rows=0 loops=1)
#     -> Index range scan on employees using PRIMARY  (cost=1.21 rows=1) (actual time=0.013..0.013 rows=0 loops=1)
#     |
#     +---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
#     1 row in set (0.00 sec)

explain analyze
select *
from employees
where emp_no in (1, 2, 3, 4, 5, 6, 7);
# | EXPLAIN                                                                                                                                                                                                                          |
#     +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
#     | -> Filter: (employees.emp_no in (1,2,3,4,5,6,7))  (cost=8.41 rows=7) (actual time=0.028..0.028 rows=0 loops=1)
#     -> Index range scan on employees using PRIMARY  (cost=8.41 rows=7) (actual time=0.027..0.027 rows=0 loops=1)
#     |
#     +----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
#     1 row in set (0.00 sec)


-- Inner hash join
explain analyze
select *
from employees,
     departments
where emp_no > 10
  and gender = 'F';
# EXPLAIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
#     +------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
#     | -> Inner hash join (no condition)  (cost=271090.92 rows=336951) (actual time=0.070..203.409 rows=1080459 loops=1)
#     -> Filter: ((employees.gender = 'F') and (employees.emp_no > 10))  (cost=23465.26 rows=74878) (actual time=0.041..121.760 rows=120051 loops=1)
#     -> Index range scan on employees using PRIMARY  (cost=23465.26 rows=149756) (actual time=0.036..89.963 rows=300024 loops=1)
#     -> Hash
#     -> Index scan on departments using dept_name  (cost=1.15 rows=9) (actual time=0.014..0.017 rows=9 loops=1)
#     |
#     +------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
#     1 row in set (0.33 sec)

-- Nested loop left join
explain analyze
select e.emp_no, s.salary
from employees e
         left join salaries s on e.emp_no = s.emp_no
where e.emp_no > 10;
# | EXPLAIN                                                                                                                                                                                                                                                                                                                                                   |
#     +-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
#     | -> Nested loop left join  (cost=451216.19 rows=2780761) (actual time=0.042..1762.936 rows=2844047 loops=1)
#     -> Index scan on e using PRIMARY  (cost=31007.31 rows=299512) (actual time=0.030..59.194 rows=300024 loops=1)
#     -> Index lookup on s using PRIMARY (emp_no=e.emp_no)  (cost=0.47 rows=9) (actual time=0.003..0.005 rows=9 loops=300024)
#     |
#     +-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
#     1 row in set (2.00 sec)


explain analyze
select *
from employees where emp_no = 10001 or emp_no = 10002;